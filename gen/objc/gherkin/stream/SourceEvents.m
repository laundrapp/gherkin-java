//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/nbransby/Documents/gherkin-java/src/main/java/gherkin/stream/SourceEvents.java
//

#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "gherkin/events/SourceEvent.h"
#include "gherkin/stream/SourceEvents.h"
#include "java/io/FileInputStream.h"
#include "java/io/IOException.h"
#include "java/io/InputStreamReader.h"
#include "java/io/Reader.h"
#include "java/lang/Iterable.h"
#include "java/lang/RuntimeException.h"
#include "java/lang/StringBuilder.h"
#include "java/lang/UnsupportedOperationException.h"
#include "java/util/Iterator.h"
#include "java/util/List.h"
#include "java/util/Spliterator.h"
#include "java/util/function/Consumer.h"

@interface GHKSourceEvents () {
 @public
  id<JavaUtilList> paths_;
}

@end

J2OBJC_FIELD_SETTER(GHKSourceEvents, paths_, id<JavaUtilList>)

__attribute__((unused)) static NSString *GHKSourceEvents_readWithJavaIoReader_(JavaIoReader *reader);

@interface GHKSourceEvents_1 : NSObject < JavaUtilIterator > {
 @public
  id<JavaUtilIterator> val$pathIterator_;
}

- (jboolean)hasNext;

- (GHKSourceEvent *)next;

- (void)remove;

@end

J2OBJC_EMPTY_STATIC_INIT(GHKSourceEvents_1)

__attribute__((unused)) static void GHKSourceEvents_1_initWithJavaUtilIterator_(GHKSourceEvents_1 *self, id<JavaUtilIterator> capture$0);

__attribute__((unused)) static GHKSourceEvents_1 *new_GHKSourceEvents_1_initWithJavaUtilIterator_(id<JavaUtilIterator> capture$0) NS_RETURNS_RETAINED;

__attribute__((unused)) static GHKSourceEvents_1 *create_GHKSourceEvents_1_initWithJavaUtilIterator_(id<JavaUtilIterator> capture$0);

@implementation GHKSourceEvents

- (instancetype __nonnull)initWithJavaUtilList:(id<JavaUtilList>)paths {
  GHKSourceEvents_initWithJavaUtilList_(self, paths);
  return self;
}

- (id<JavaUtilIterator>)iterator {
  id<JavaUtilIterator> pathIterator = [((id<JavaUtilList>) nil_chk(paths_)) iterator];
  return create_GHKSourceEvents_1_initWithJavaUtilIterator_(pathIterator);
}

- (void)forEachWithJavaUtilFunctionConsumer:(id<JavaUtilFunctionConsumer>)arg0 {
  JavaLangIterable_forEachWithJavaUtilFunctionConsumer_(self, arg0);
}

- (id<JavaUtilSpliterator>)spliterator {
  return JavaLangIterable_spliterator(self);
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf);
}

- (void)dealloc {
  RELEASE_(paths_);
  [super dealloc];
}

@end

void GHKSourceEvents_initWithJavaUtilList_(GHKSourceEvents *self, id<JavaUtilList> paths) {
  NSObject_init(self);
  JreStrongAssign(&self->paths_, paths);
}

GHKSourceEvents *new_GHKSourceEvents_initWithJavaUtilList_(id<JavaUtilList> paths) {
  J2OBJC_NEW_IMPL(GHKSourceEvents, initWithJavaUtilList_, paths)
}

GHKSourceEvents *create_GHKSourceEvents_initWithJavaUtilList_(id<JavaUtilList> paths) {
  J2OBJC_CREATE_IMPL(GHKSourceEvents, initWithJavaUtilList_, paths)
}

NSString *GHKSourceEvents_readWithJavaIoReader_(JavaIoReader *reader) {
  GHKSourceEvents_initialize();
  IOSCharArray *buffer = [IOSCharArray arrayWithLength:(jint) 0x10000];
  JavaLangStringBuilder *sb = create_JavaLangStringBuilder_init();
  jint read;
  do {
    read = [((JavaIoReader *) nil_chk(reader)) readWithCharArray:buffer withInt:0 withInt:buffer->size_];
    if (read > 0) {
      [sb appendWithCharArray:buffer withInt:0 withInt:read];
    }
  }
  while (read >= 0);
  return [sb description];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GHKSourceEvents)

@implementation GHKSourceEvents_1

- (jboolean)hasNext {
  return [((id<JavaUtilIterator>) nil_chk(val$pathIterator_)) hasNext];
}

- (GHKSourceEvent *)next {
  @try {
    NSString *path = [((id<JavaUtilIterator>) nil_chk(val$pathIterator_)) next];
    NSString *data = GHKSourceEvents_readWithJavaIoReader_(create_JavaIoInputStreamReader_initWithJavaIoInputStream_withNSString_(create_JavaIoFileInputStream_initWithNSString_(path), @"UTF-8"));
    return create_GHKSourceEvent_initWithNSString_withNSString_(path, data);
  }
  @catch (JavaIoIOException *e) {
    @throw create_JavaLangRuntimeException_initWithJavaLangThrowable_(e);
  }
}

- (void)remove {
  @throw create_JavaLangUnsupportedOperationException_init();
}

- (void)forEachRemainingWithJavaUtilFunctionConsumer:(id<JavaUtilFunctionConsumer>)arg0 {
  JavaUtilIterator_forEachRemainingWithJavaUtilFunctionConsumer_(self, arg0);
}

- (void)dealloc {
  RELEASE_(val$pathIterator_);
  [super dealloc];
}

@end

void GHKSourceEvents_1_initWithJavaUtilIterator_(GHKSourceEvents_1 *self, id<JavaUtilIterator> capture$0) {
  JreStrongAssign(&self->val$pathIterator_, capture$0);
  NSObject_init(self);
}

GHKSourceEvents_1 *new_GHKSourceEvents_1_initWithJavaUtilIterator_(id<JavaUtilIterator> capture$0) {
  J2OBJC_NEW_IMPL(GHKSourceEvents_1, initWithJavaUtilIterator_, capture$0)
}

GHKSourceEvents_1 *create_GHKSourceEvents_1_initWithJavaUtilIterator_(id<JavaUtilIterator> capture$0) {
  J2OBJC_CREATE_IMPL(GHKSourceEvents_1, initWithJavaUtilIterator_, capture$0)
}
