//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/marcussmith/HambroPerks/laundrapp_org/gherkin-java/src/main/java/gherkin/cli/Main.java
//

#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "gherkin/cli/Main.h"
#include "gherkin/deps/com/google/gson/Gson.h"
#include "gherkin/deps/com/google/gson/GsonBuilder.h"
#include "gherkin/events/CucumberEvent.h"
#include "gherkin/events/SourceEvent.h"
#include "gherkin/stream/GherkinEvents.h"
#include "gherkin/stream/SourceEvents.h"
#include "gherkin/stream/Stdio.h"
#include "java/io/PrintWriter.h"
#include "java/lang/Iterable.h"
#include "java/util/ArrayList.h"
#include "java/util/Arrays.h"
#include "java/util/List.h"

@implementation GherkinCliMain

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype __nonnull)init {
  GherkinCliMain_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

+ (void)mainWithNSStringArray:(IOSObjectArray *)argv {
  GherkinCliMain_mainWithNSStringArray_(argv);
}

@end

void GherkinCliMain_init(GherkinCliMain *self) {
  NSObject_init(self);
}

GherkinCliMain *new_GherkinCliMain_init() {
  J2OBJC_NEW_IMPL(GherkinCliMain, init)
}

GherkinCliMain *create_GherkinCliMain_init() {
  J2OBJC_CREATE_IMPL(GherkinCliMain, init)
}

void GherkinCliMain_mainWithNSStringArray_(IOSObjectArray *argv) {
  GherkinCliMain_initialize();
  GherkinDepsComGoogleGsonGson *gson = [create_GherkinDepsComGoogleGsonGsonBuilder_init() create];
  id<JavaUtilList> args = create_JavaUtilArrayList_initWithJavaUtilCollection_(JavaUtilArrays_asListWithNSObjectArray_(argv));
  id<JavaUtilList> paths = create_JavaUtilArrayList_init();
  jboolean printSource = true;
  jboolean printAst = true;
  jboolean printPickles = true;
  while (![args isEmpty]) {
    NSString *arg = [((NSString *) nil_chk([args removeWithInt:0])) java_trim];
    switch (JreIndexOfStr(arg, (id[]){ @"--no-source", @"--no-ast", @"--no-pickles" }, 3)) {
      case 0:
      printSource = false;
      break;
      case 1:
      printAst = false;
      break;
      case 2:
      printPickles = false;
      break;
      default:
      [paths addWithId:arg];
    }
  }
  GherkinStreamSourceEvents *sourceEvents = create_GherkinStreamSourceEvents_initWithJavaUtilList_(paths);
  GherkinStreamGherkinEvents *gherkinEvents = create_GherkinStreamGherkinEvents_initWithBoolean_withBoolean_withBoolean_(printSource, printAst, printPickles);
  for (GherkinEventsSourceEvent * __strong sourceEventEvent in sourceEvents) {
    for (id<GherkinEventsCucumberEvent> __strong cucumberEvent in nil_chk([gherkinEvents iterableWithGherkinEventsSourceEvent:sourceEventEvent])) {
      [((JavaIoPrintWriter *) nil_chk(JreLoadStatic(GherkinStreamStdio, out))) writeWithNSString:[((GherkinDepsComGoogleGsonGson *) nil_chk(gson)) toJsonWithId:cucumberEvent]];
      [JreLoadStatic(GherkinStreamStdio, out) writeWithNSString:@"\n"];
      [JreLoadStatic(GherkinStreamStdio, out) flush];
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GherkinCliMain)
