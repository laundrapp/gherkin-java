//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/marcussmith/HambroPerks/laundrapp_org/gherkin-java/src/main/java/gherkin/pickles/Compiler.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "gherkin/SymbolCounter.h"
#include "gherkin/ast/Background.h"
#include "gherkin/ast/DataTable.h"
#include "gherkin/ast/DocString.h"
#include "gherkin/ast/Examples.h"
#include "gherkin/ast/Feature.h"
#include "gherkin/ast/GherkinDocument.h"
#include "gherkin/ast/Location.h"
#include "gherkin/ast/Node.h"
#include "gherkin/ast/Scenario.h"
#include "gherkin/ast/ScenarioDefinition.h"
#include "gherkin/ast/ScenarioOutline.h"
#include "gherkin/ast/Step.h"
#include "gherkin/ast/TableCell.h"
#include "gherkin/ast/TableRow.h"
#include "gherkin/ast/Tag.h"
#include "gherkin/pickles/Compiler.h"
#include "gherkin/pickles/Pickle.h"
#include "gherkin/pickles/PickleCell.h"
#include "gherkin/pickles/PickleLocation.h"
#include "gherkin/pickles/PickleRow.h"
#include "gherkin/pickles/PickleStep.h"
#include "gherkin/pickles/PickleString.h"
#include "gherkin/pickles/PickleTable.h"
#include "gherkin/pickles/PickleTag.h"
#include "java/lang/RuntimeException.h"
#include "java/util/ArrayList.h"
#include "java/util/Arrays.h"
#include "java/util/Collections.h"
#include "java/util/List.h"

__attribute__((unused)) static void GherkinPicklesCompiler_compileScenarioWithJavaUtilList_withJavaUtilList_withGherkinAstScenario_withJavaUtilList_withNSString_(GherkinPicklesCompiler *self, id<JavaUtilList> pickles, id<JavaUtilList> backgroundSteps, GherkinAstScenario *scenario, id<JavaUtilList> featureTags, NSString *language);

__attribute__((unused)) static void GherkinPicklesCompiler_compileScenarioOutlineWithJavaUtilList_withJavaUtilList_withGherkinAstScenarioOutline_withJavaUtilList_withNSString_(GherkinPicklesCompiler *self, id<JavaUtilList> pickles, id<JavaUtilList> backgroundSteps, GherkinAstScenarioOutline *scenarioOutline, id<JavaUtilList> featureTags, NSString *language);

__attribute__((unused)) static id<JavaUtilList> GherkinPicklesCompiler_createPickleArgumentsWithGherkinAstNode_(GherkinPicklesCompiler *self, GherkinAstNode *argument);

__attribute__((unused)) static id<JavaUtilList> GherkinPicklesCompiler_createPickleArgumentsWithGherkinAstNode_withJavaUtilList_withJavaUtilList_(GherkinPicklesCompiler *self, GherkinAstNode *argument, id<JavaUtilList> variableCells, id<JavaUtilList> valueCells);

__attribute__((unused)) static id<JavaUtilList> GherkinPicklesCompiler_pickleStepsWithGherkinAstScenarioDefinition_(GherkinPicklesCompiler *self, GherkinAstScenarioDefinition *scenarioDefinition);

__attribute__((unused)) static GherkinPicklesPickleStep *GherkinPicklesCompiler_pickleStepWithGherkinAstStep_(GherkinPicklesCompiler *self, GherkinAstStep *step);

__attribute__((unused)) static NSString *GherkinPicklesCompiler_interpolateWithNSString_withJavaUtilList_withJavaUtilList_(GherkinPicklesCompiler *self, NSString *name, id<JavaUtilList> variableCells, id<JavaUtilList> valueCells);

__attribute__((unused)) static GherkinPicklesPickleLocation *GherkinPicklesCompiler_pickleStepLocationWithGherkinAstStep_(GherkinPicklesCompiler *self, GherkinAstStep *step);

__attribute__((unused)) static GherkinPicklesPickleLocation *GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(GherkinPicklesCompiler *self, GherkinAstLocation *location);

__attribute__((unused)) static id<JavaUtilList> GherkinPicklesCompiler_pickleTagsWithJavaUtilList_(GherkinPicklesCompiler *self, id<JavaUtilList> tags);

__attribute__((unused)) static GherkinPicklesPickleTag *GherkinPicklesCompiler_pickleTagWithGherkinAstTag_(GherkinPicklesCompiler *self, GherkinAstTag *tag);

@implementation GherkinPicklesCompiler

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype __nonnull)init {
  GherkinPicklesCompiler_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (id<JavaUtilList>)compileWithGherkinAstGherkinDocument:(GherkinAstGherkinDocument *)gherkinDocument {
  id<JavaUtilList> pickles = create_JavaUtilArrayList_init();
  GherkinAstFeature *feature = [((GherkinAstGherkinDocument *) nil_chk(gherkinDocument)) getFeature];
  if (feature == nil) {
    return pickles;
  }
  NSString *language = [feature getLanguage];
  id<JavaUtilList> featureTags = [feature getTags];
  id<JavaUtilList> backgroundSteps = create_JavaUtilArrayList_init();
  for (GherkinAstScenarioDefinition * __strong scenarioDefinition in nil_chk([feature getChildren])) {
    if ([scenarioDefinition isKindOfClass:[GherkinAstBackground class]]) {
      backgroundSteps = GherkinPicklesCompiler_pickleStepsWithGherkinAstScenarioDefinition_(self, scenarioDefinition);
    }
    else if ([scenarioDefinition isKindOfClass:[GherkinAstScenario class]]) {
      GherkinPicklesCompiler_compileScenarioWithJavaUtilList_withJavaUtilList_withGherkinAstScenario_withJavaUtilList_withNSString_(self, pickles, backgroundSteps, (GherkinAstScenario *) cast_chk(scenarioDefinition, [GherkinAstScenario class]), featureTags, language);
    }
    else {
      GherkinPicklesCompiler_compileScenarioOutlineWithJavaUtilList_withJavaUtilList_withGherkinAstScenarioOutline_withJavaUtilList_withNSString_(self, pickles, backgroundSteps, (GherkinAstScenarioOutline *) cast_chk(scenarioDefinition, [GherkinAstScenarioOutline class]), featureTags, language);
    }
  }
  return pickles;
}

@end

void GherkinPicklesCompiler_init(GherkinPicklesCompiler *self) {
  NSObject_init(self);
}

GherkinPicklesCompiler *new_GherkinPicklesCompiler_init() {
  J2OBJC_NEW_IMPL(GherkinPicklesCompiler, init)
}

GherkinPicklesCompiler *create_GherkinPicklesCompiler_init() {
  J2OBJC_CREATE_IMPL(GherkinPicklesCompiler, init)
}

void GherkinPicklesCompiler_compileScenarioWithJavaUtilList_withJavaUtilList_withGherkinAstScenario_withJavaUtilList_withNSString_(GherkinPicklesCompiler *self, id<JavaUtilList> pickles, id<JavaUtilList> backgroundSteps, GherkinAstScenario *scenario, id<JavaUtilList> featureTags, NSString *language) {
  id<JavaUtilList> steps = create_JavaUtilArrayList_init();
  if (![((id<JavaUtilList>) nil_chk([((GherkinAstScenario *) nil_chk(scenario)) getSteps])) isEmpty]) [steps addAllWithJavaUtilCollection:backgroundSteps];
  id<JavaUtilList> scenarioTags = create_JavaUtilArrayList_init();
  [scenarioTags addAllWithJavaUtilCollection:featureTags];
  [scenarioTags addAllWithJavaUtilCollection:[scenario getTags]];
  [steps addAllWithJavaUtilCollection:GherkinPicklesCompiler_pickleStepsWithGherkinAstScenarioDefinition_(self, scenario)];
  GherkinPicklesPickle *pickle = create_GherkinPicklesPickle_initWithNSString_withNSString_withJavaUtilList_withJavaUtilList_withJavaUtilList_([scenario getName], language, steps, GherkinPicklesCompiler_pickleTagsWithJavaUtilList_(self, scenarioTags), JavaUtilCollections_singletonListWithId_(GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(self, [scenario getLocation])));
  [((id<JavaUtilList>) nil_chk(pickles)) addWithId:pickle];
}

void GherkinPicklesCompiler_compileScenarioOutlineWithJavaUtilList_withJavaUtilList_withGherkinAstScenarioOutline_withJavaUtilList_withNSString_(GherkinPicklesCompiler *self, id<JavaUtilList> pickles, id<JavaUtilList> backgroundSteps, GherkinAstScenarioOutline *scenarioOutline, id<JavaUtilList> featureTags, NSString *language) {
  for (GherkinAstExamples * __strong examples in nil_chk([((GherkinAstScenarioOutline *) nil_chk(scenarioOutline)) getExamples])) {
    if ([((GherkinAstExamples *) nil_chk(examples)) getTableHeader] == nil) continue;
    id<JavaUtilList> variableCells = [((GherkinAstTableRow *) nil_chk([examples getTableHeader])) getCells];
    for (GherkinAstTableRow * __strong values in nil_chk([examples getTableBody])) {
      id<JavaUtilList> valueCells = [((GherkinAstTableRow *) nil_chk(values)) getCells];
      id<JavaUtilList> steps = create_JavaUtilArrayList_init();
      if (![((id<JavaUtilList>) nil_chk([scenarioOutline getSteps])) isEmpty]) [steps addAllWithJavaUtilCollection:backgroundSteps];
      id<JavaUtilList> tags = create_JavaUtilArrayList_init();
      [tags addAllWithJavaUtilCollection:featureTags];
      [tags addAllWithJavaUtilCollection:[scenarioOutline getTags]];
      [tags addAllWithJavaUtilCollection:[examples getTags]];
      for (GherkinAstStep * __strong scenarioOutlineStep in nil_chk([scenarioOutline getSteps])) {
        NSString *stepText = GherkinPicklesCompiler_interpolateWithNSString_withJavaUtilList_withJavaUtilList_(self, [((GherkinAstStep *) nil_chk(scenarioOutlineStep)) getText], variableCells, valueCells);
        GherkinPicklesPickleStep *pickleStep = create_GherkinPicklesPickleStep_initWithNSString_withJavaUtilList_withJavaUtilList_(stepText, GherkinPicklesCompiler_createPickleArgumentsWithGherkinAstNode_withJavaUtilList_withJavaUtilList_(self, [scenarioOutlineStep getArgument], variableCells, valueCells), JavaUtilArrays_asListWithNSObjectArray_([IOSObjectArray arrayWithObjects:(id[]){ GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(self, [values getLocation]), GherkinPicklesCompiler_pickleStepLocationWithGherkinAstStep_(self, scenarioOutlineStep) } count:2 type:GherkinPicklesPickleLocation_class_()]));
        [steps addWithId:pickleStep];
      }
      GherkinPicklesPickle *pickle = create_GherkinPicklesPickle_initWithNSString_withNSString_withJavaUtilList_withJavaUtilList_withJavaUtilList_(GherkinPicklesCompiler_interpolateWithNSString_withJavaUtilList_withJavaUtilList_(self, [scenarioOutline getName], variableCells, valueCells), language, steps, GherkinPicklesCompiler_pickleTagsWithJavaUtilList_(self, tags), JavaUtilArrays_asListWithNSObjectArray_([IOSObjectArray arrayWithObjects:(id[]){ GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(self, [values getLocation]), GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(self, [scenarioOutline getLocation]) } count:2 type:GherkinPicklesPickleLocation_class_()]));
      [((id<JavaUtilList>) nil_chk(pickles)) addWithId:pickle];
    }
  }
}

id<JavaUtilList> GherkinPicklesCompiler_createPickleArgumentsWithGherkinAstNode_(GherkinPicklesCompiler *self, GherkinAstNode *argument) {
  id<JavaUtilList> noCells = JavaUtilCollections_emptyList();
  return GherkinPicklesCompiler_createPickleArgumentsWithGherkinAstNode_withJavaUtilList_withJavaUtilList_(self, argument, noCells, noCells);
}

id<JavaUtilList> GherkinPicklesCompiler_createPickleArgumentsWithGherkinAstNode_withJavaUtilList_withJavaUtilList_(GherkinPicklesCompiler *self, GherkinAstNode *argument, id<JavaUtilList> variableCells, id<JavaUtilList> valueCells) {
  id<JavaUtilList> result = create_JavaUtilArrayList_init();
  if (argument == nil) return result;
  if ([argument isKindOfClass:[GherkinAstDataTable class]]) {
    GherkinAstDataTable *t = (GherkinAstDataTable *) cast_chk(argument, [GherkinAstDataTable class]);
    id<JavaUtilList> rows = [t getRows];
    id<JavaUtilList> newRows = create_JavaUtilArrayList_initWithInt_([((id<JavaUtilList>) nil_chk(rows)) size]);
    for (GherkinAstTableRow * __strong row in rows) {
      id<JavaUtilList> cells = [((GherkinAstTableRow *) nil_chk(row)) getCells];
      id<JavaUtilList> newCells = create_JavaUtilArrayList_init();
      for (GherkinAstTableCell * __strong cell in nil_chk(cells)) {
        [newCells addWithId:create_GherkinPicklesPickleCell_initWithGherkinPicklesPickleLocation_withNSString_(GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(self, [((GherkinAstTableCell *) nil_chk(cell)) getLocation]), GherkinPicklesCompiler_interpolateWithNSString_withJavaUtilList_withJavaUtilList_(self, [cell getValue], variableCells, valueCells))];
      }
      [newRows addWithId:create_GherkinPicklesPickleRow_initWithJavaUtilList_(newCells)];
    }
    [result addWithId:create_GherkinPicklesPickleTable_initWithJavaUtilList_(newRows)];
  }
  else if ([argument isKindOfClass:[GherkinAstDocString class]]) {
    GherkinAstDocString *ds = (GherkinAstDocString *) cast_chk(argument, [GherkinAstDocString class]);
    [result addWithId:create_GherkinPicklesPickleString_initWithGherkinPicklesPickleLocation_withNSString_withNSString_(GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(self, [ds getLocation]), GherkinPicklesCompiler_interpolateWithNSString_withJavaUtilList_withJavaUtilList_(self, [ds getContent], variableCells, valueCells), [ds getContentType] == nil ? nil : GherkinPicklesCompiler_interpolateWithNSString_withJavaUtilList_withJavaUtilList_(self, [ds getContentType], variableCells, valueCells))];
  }
  else {
    @throw create_JavaLangRuntimeException_initWithNSString_(JreStrcat("$@", @"Unexpected argument type: ", argument));
  }
  return result;
}

id<JavaUtilList> GherkinPicklesCompiler_pickleStepsWithGherkinAstScenarioDefinition_(GherkinPicklesCompiler *self, GherkinAstScenarioDefinition *scenarioDefinition) {
  id<JavaUtilList> result = create_JavaUtilArrayList_init();
  for (GherkinAstStep * __strong step in nil_chk([((GherkinAstScenarioDefinition *) nil_chk(scenarioDefinition)) getSteps])) {
    [result addWithId:GherkinPicklesCompiler_pickleStepWithGherkinAstStep_(self, step)];
  }
  return JavaUtilCollections_unmodifiableListWithJavaUtilList_(result);
}

GherkinPicklesPickleStep *GherkinPicklesCompiler_pickleStepWithGherkinAstStep_(GherkinPicklesCompiler *self, GherkinAstStep *step) {
  return create_GherkinPicklesPickleStep_initWithNSString_withJavaUtilList_withJavaUtilList_([((GherkinAstStep *) nil_chk(step)) getText], GherkinPicklesCompiler_createPickleArgumentsWithGherkinAstNode_(self, [step getArgument]), JavaUtilCollections_singletonListWithId_(GherkinPicklesCompiler_pickleStepLocationWithGherkinAstStep_(self, step)));
}

NSString *GherkinPicklesCompiler_interpolateWithNSString_withJavaUtilList_withJavaUtilList_(GherkinPicklesCompiler *self, NSString *name, id<JavaUtilList> variableCells, id<JavaUtilList> valueCells) {
  jint col = 0;
  for (GherkinAstTableCell * __strong variableCell in nil_chk(variableCells)) {
    GherkinAstTableCell *valueCell = [((id<JavaUtilList>) nil_chk(valueCells)) getWithInt:col++];
    NSString *header = [((GherkinAstTableCell *) nil_chk(variableCell)) getValue];
    NSString *value = [((GherkinAstTableCell *) nil_chk(valueCell)) getValue];
    name = [((NSString *) nil_chk(name)) java_replace:JreStrcat("C$C", '<', header, '>') withSequence:value];
  }
  return name;
}

GherkinPicklesPickleLocation *GherkinPicklesCompiler_pickleStepLocationWithGherkinAstStep_(GherkinPicklesCompiler *self, GherkinAstStep *step) {
  return create_GherkinPicklesPickleLocation_initWithInt_withInt_([((GherkinAstLocation *) nil_chk([((GherkinAstStep *) nil_chk(step)) getLocation])) getLine], [((GherkinAstLocation *) nil_chk([step getLocation])) getColumn] + ([step getKeyword] != nil ? GherkinSymbolCounter_countSymbolsWithNSString_([step getKeyword]) : 0));
}

GherkinPicklesPickleLocation *GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(GherkinPicklesCompiler *self, GherkinAstLocation *location) {
  return create_GherkinPicklesPickleLocation_initWithInt_withInt_([((GherkinAstLocation *) nil_chk(location)) getLine], [location getColumn]);
}

id<JavaUtilList> GherkinPicklesCompiler_pickleTagsWithJavaUtilList_(GherkinPicklesCompiler *self, id<JavaUtilList> tags) {
  id<JavaUtilList> result = create_JavaUtilArrayList_init();
  for (GherkinAstTag * __strong tag in nil_chk(tags)) {
    [result addWithId:GherkinPicklesCompiler_pickleTagWithGherkinAstTag_(self, tag)];
  }
  return result;
}

GherkinPicklesPickleTag *GherkinPicklesCompiler_pickleTagWithGherkinAstTag_(GherkinPicklesCompiler *self, GherkinAstTag *tag) {
  return create_GherkinPicklesPickleTag_initWithGherkinPicklesPickleLocation_withNSString_(GherkinPicklesCompiler_pickleLocationWithGherkinAstLocation_(self, [((GherkinAstTag *) nil_chk(tag)) getLocation]), [tag getName]);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GherkinPicklesCompiler)
